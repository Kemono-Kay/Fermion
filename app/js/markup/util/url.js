// Doesn't 100% correctly fail malformed query / matrix parameters yet.
const validationRegex = /^(?:[a-z0-9.+-]*):(?:\/\/)?(?:[^:]+(?::.*)?@)?(?:(?:[^;,/?.:@&=+$\s]+\.)+[^;,/?.:@&=+$\s0-9]+|(?:[0-9]{1,3}\.){3}[0-9]{1,3}|\[((?=.*::)(?!.*::.+::)(::)?([\dA-F]{1,4}:(:|\b)|){5}|([\dA-F]{1,4}:){6})((([\dA-F]{1,4}((?!\3)::|:\b|))|(?!\2\3)){2}|(((2[0-4]|1\d|[1-9])?\d|25[0-5])\.?\b){4})\])(?::[0-9]{1,5})?(?:\/[^;,/?:@&=+$\s]*)*(?:;(?:(?:[^;,/?:@&=+$\s#]*(?:=[^;/?:@&=+$\s#]*)?(?:&|;))*[^;,/?:@&=+$\s#]*(?:=[^;/?:@&=+$\s#]*)?)?)?(?:\?(?:(?:[^;,/?:@&=+$\s#]*(?:=[^;/?:@&=+$\s#]*)?(?:&|;))*[^;,/?:@&=+$\s#]*(?:=[^;/?:@&=+$\s#]*)?)?)?(?:#[^\s]*)?$/ui
const domainRegex = /^(?:[a-z0-9.+-]*):(?:\/\/)?(?:[^:]+(?::.*)?@)?(?:www\.)?(.*?)(?::[0-9]{1,5})?(?:\/[^;,/?:@&=+$\s]*)*(?:;(?:(?:[^;,/?:@&=+$\s#]*(?:=[^;/?:@&=+$\s#]*)?(?:&|;))*[^;,/?:@&=+$\s#]*(?:=[^;/?:@&=+$\s#]*)?)?)?(?:\?(?:(?:[^;,/?:@&=+$\s#]*(?:=[^;/?:@&=+$\s#]*)?(?:&|;))*[^;,/?:@&=+$\s#]*(?:=[^;/?:@&=+$\s#]*)?)?)?(?:#[^\s]*)?$/ui

module.exports = { validationRegex, domainRegex }
